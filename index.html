<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–¥—Ä–µ—Å–∞ —Å —Ç–∞–π–º–ª–æ–∫–æ–º (BTC Mainnet)</title>
</head>
<body>
  <h1>üîê –ê–¥—Ä–µ—Å —Å —Ç–∞–π–º–ª–æ–∫–æ–º –¥–ª—è BTC Mainnet</h1>

  <p>
    <label for="locktime">‚è≥ UNIX-–≤—Ä–µ–º—è (locktime):</label><br>
    <input type="number" id="locktime" placeholder="–í–≤–µ–¥–∏—Ç–µ UNIX-–≤—Ä–µ–º—è">
  </p>

  <p>üìÖ –ò–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:</p>
  <input type="date" id="date">

  <p><button onclick="generate()">üé≤ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button></p>

  <p><strong>üîë WIF:</strong> <span id="wif"></span></p>
  <p><strong>üì¢ –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á:</strong> <span id="pubkey"></span></p>
  <p><strong>üßæ Redeem-—Å–∫—Ä–∏–ø—Ç:</strong> <span id="redeemScript"></span></p>
  <p><strong>üì¨ P2SH Mainnet-–∞–¥—Ä–µ—Å:</strong> <span id="address"></span></p>

  <script src="https://cdn.jsdelivr.net/npm/bitcoinjs-lib@6.1.7/dist/bitcoinjs-lib.umd.js"></script>
  <script>
    function generate() {
      try {
        const bitcoin = window.bitcoinjs;
        const mainnet = bitcoin.networks.bitcoin;

        const keyPair = bitcoin.ECPair.makeRandom({ network: mainnet });

        const locktimeInput = document.getElementById('locktime').value;
        const locktime = locktimeInput ? parseInt(locktimeInput) : Math.floor(Date.now() / 1000) + 86400;

        const redeemScript = bitcoin.script.compile([
          bitcoin.script.number.encode(locktime),
          bitcoin.opcodes.OP_CHECKLOCKTIMEVERIFY,
          bitcoin.opcodes.OP_DROP,
          bitcoin.opcodes.OP_DUP,
          bitcoin.opcodes.OP_HASH160,
          bitcoin.crypto.hash160(keyPair.publicKey),
          bitcoin.opcodes.OP_EQUALVERIFY,
          bitcoin.opcodes.OP_CHECKSIG
        ]);

        const p2sh = bitcoin.payments.p2sh({
          redeem: { output: redeemScript, network: mainnet },
          network: mainnet
        });

        document.getElementById('wif').textContent = keyPair.toWIF();
        document.getElementById('pubkey').textContent = keyPair.publicKey.toString('hex');
        document.getElementById('redeemScript').textContent = redeemScript.toString('hex');
        document.getElementById('address').textContent = p2sh.address;
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–∞:', error);
        alert('–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–∞: ' + error.message);
      }
    }

    document.getElementById('date').addEventListener('change', function() {
      const date = new Date(this.value);
      document.getElementById('locktime').value = Math.floor(date.getTime() / 1000);
    });
  </script>
</body>
</html>
